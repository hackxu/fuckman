<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<canvas id="shuju" width="500" height="500"></canvas>
<script type="text/javascript">


    var scxt = document.getElementById('shuju').getContext('2d');
    image = document.images[0],
            imageData, data,
            i, len, average,
            red, green, blue, alpha;

   /* var imageData = scxt.getImageData(10, 5, 50, 50);
    var data = imageData.data;
    red = data[0];
    green = data[1];
    blue = data[2];
    alpha = data[3];*/
    //绘制原始图像
    scxt.drawImage(image, 0, 0);
    //取得图像数据
    imageData =scxt.getImageData(0,0,image.width,image.height);
    data = imageData.data;

    for(i = 0,len = data.length;i<len;i+=4){
        red = data[i];
        green = data[i+1];
        blue = data [i+2];
        alpha = data[i+3];

        //求的rgb平均值
        average = Math.floor((red + green + blue) / 3);

        // 设置颜色直，透明度不变
        data[i] = average;
        data[i+1] = average;
        data[i+2] = average;

    }
    //回写图像数据并显示结果

    imageData.data = data;
    scxt.putImageData(imageData,0,0);
</script>
</body>
</html>